<!DOCTYPE html>
<html>
<head>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: Inter, system-ui, -apple-system, sans-serif;
    padding: 16px;
    color: #333;
    background: #fff;
  }
  h3 {
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 4px;
  }
  .desc {
    font-size: 12px;
    color: #666;
    margin-bottom: 12px;
    line-height: 1.4;
  }
  textarea {
    width: 100%;
    height: 140px;
    margin-bottom: 12px;
    padding: 8px 10px;
    font-family: 'SF Mono', SFMono-Regular, Menlo, monospace;
    font-size: 11px;
    line-height: 1.4;
    border: 1px solid #ddd;
    border-radius: 6px;
    resize: vertical;
    background: #fafafa;
    color: #333;
  }
  textarea:focus {
    outline: none;
    border-color: #18a0fb;
    background: #fff;
  }
  button {
    display: block;
    width: 100%;
    padding: 10px 16px;
    font-family: inherit;
    font-size: 13px;
    font-weight: 600;
    border: none;
    border-radius: 6px;
    background: #18a0fb;
    color: #fff;
    cursor: pointer;
    transition: background 0.15s;
  }
  button:hover { background: #0c8ce9; }
  button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  .status {
    margin-top: 10px;
    font-size: 12px;
    text-align: center;
    min-height: 18px;
  }
  .status.success { color: #1bc47d; }
  .status.error { color: #f24822; }
  .tip {
    margin-top: 12px;
    font-size: 11px;
    color: #999;
    line-height: 1.4;
  }
</style>
</head>
<body>
  <h3>PDF Designer Import</h3>
  <p class="desc">
    Click "Export to Figma" in the PDF Designer app, then paste the
    copied JSON below.
  </p>
  <textarea id="json" placeholder="Paste JSON here..."></textarea>
  <button id="import-btn" onclick="importDesign()">Import Design</button>
  <div id="status" class="status"></div>
  <p class="tip">
    Tip: The JSON is copied to your clipboard when you click
    "Export to Figma" in the web app.
  </p>

  <script>
    const statusEl = document.getElementById('status')
    const btnEl = document.getElementById('import-btn')

    function importDesign() {
      const json = document.getElementById('json').value.trim()
      if (!json) {
        showStatus('Paste the JSON first', 'error')
        return
      }

      let data
      try {
        data = JSON.parse(json)
      } catch (e) {
        showStatus('Invalid JSON: ' + e.message, 'error')
        return
      }

      if (!data.version || !data.pages) {
        showStatus('Not a valid PDF Designer export', 'error')
        return
      }

      btnEl.disabled = true
      btnEl.textContent = 'Importing...'
      showStatus('Creating layers...', '')

      parent.postMessage({
        pluginMessage: { type: 'import', data }
      }, '*')
    }

    function showStatus(msg, type) {
      statusEl.textContent = msg
      statusEl.className = 'status' + (type ? ' ' + type : '')
    }

    window.onmessage = (event) => {
      const msg = event.data.pluginMessage
      if (!msg) return

      btnEl.disabled = false
      btnEl.textContent = 'Import Design'

      if (msg.type === 'success') {
        showStatus(msg.message, 'success')
      } else if (msg.type === 'error') {
        showStatus(msg.message, 'error')
      }
    }
  </script>
</body>
</html>
